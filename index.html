<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyVidio — Видеоконференции с демонстрацией экрана</title>
    
    <!-- Иконка сайта -->
    <link rel="icon" type="image/png" href="https://img.icons8.com/fluency/96/000000/video-call.png">
    <link rel="apple-touch-icon" href="https://img.icons8.com/fluency/180/000000/video-call.png">
    
    <!-- Jitsi Meet API -->
    <script src='https://meet.jit.si/external_api.js'></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #0c5c8c;
            color: white;
            line-height: 1.6;
        }

        /* Шапка */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 5%;
            background-color: rgba(0, 0, 0, 0.2);
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #2d8cff;
            cursor: pointer;
        }

        .auth-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .sign-in {
            background: transparent;
            color: white;
            border: 1px solid white;
        }

        .sign-up {
            background: #2d8cff;
            color: white;
        }

        /* Основной блок */
        .hero {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 80px 5%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .hero-text {
            flex: 1;
            padding-right: 40px;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
            max-width: 600px;
        }

        .cta-buttons {
            margin-top: 30px;
        }

        .meeting-btn {
            padding: 15px 30px;
            background-color: #2d8cff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            font-weight: bold;
            margin-right: 15px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .meeting-btn:hover {
            background-color: #1a73e8;
        }

        .record-btn {
            background-color: #ff4444;
        }

        .record-btn:hover {
            background-color: #cc0000;
        }

        /* Форма создания комнаты */
        .room-creator {
            flex: 1;
            background: #1a3a5f;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .room-creator h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2d8cff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            background: #0a2640;
            color: white;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }

        .checkbox-group input {
            width: auto;
        }

        /* Контейнер для Jitsi */
        #meet-container {
            display: none;
            width: 100%;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            background: black;
        }

        /* ВИДЕО ПЛЕЕР */
        .video-player-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .video-player {
            width: 100%;
            max-width: 1200px;
            background: #111;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .video-player-header {
            padding: 20px;
            background: #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-player-header h3 {
            color: white;
            margin: 0;
            font-size: 1.3rem;
        }

        .close-player {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-player:hover {
            background: rgba(255,255,255,0.1);
        }

        .video-wrapper {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 соотношение */
            background: #000;
        }

        #videoPlayer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
        }

        .player-controls {
            padding: 20px;
            background: #222;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .play-pause-btn {
            background: #2d8cff;
        }

        .play-pause-btn:hover {
            background: #1a73e8;
        }

        .progress-container {
            flex: 1;
            height: 6px;
            background: #444;
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: #2d8cff;
            border-radius: 3px;
            width: 0%;
        }

        .progress-slider {
            position: absolute;
            top: -7px;
            left: 0;
            width: 20px;
            height: 20px;
            background: #2d8cff;
            border-radius: 50%;
            transform: translateX(-50%);
            cursor: grab;
        }

        .time-display {
            color: white;
            font-family: monospace;
            font-size: 1rem;
            min-width: 100px;
            text-align: center;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider {
            width: 80px;
            height: 6px;
            background: #444;
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .volume-level {
            height: 100%;
            background: white;
            border-radius: 3px;
            width: 70%;
        }

        .volume-slider-handle {
            position: absolute;
            top: -7px;
            right: 30%;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transform: translateX(50%);
            cursor: grab;
        }

        .player-settings {
            position: relative;
        }

        .settings-menu {
            position: absolute;
            bottom: 60px;
            right: 0;
            background: #333;
            border-radius: 8px;
            padding: 15px;
            min-width: 200px;
            display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .settings-menu.show {
            display: block;
        }

        .settings-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            color: white;
            border-bottom: 1px solid #444;
        }

        .settings-option:last-child {
            border-bottom: none;
        }

        .speed-options {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .speed-btn {
            padding: 5px 10px;
            background: #444;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .speed-btn.active {
            background: #2d8cff;
        }

        /* МЕНЮ ВЫБОРА ЭКРАНА */
        .screen-select-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2001;
            justify-content: center;
            align-items: center;
        }

        .screen-select-modal {
            background: #222;
            border-radius: 15px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            color: white;
        }

        .screen-select-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .screen-select-header h3 {
            font-size: 1.8rem;
            color: #2d8cff;
            margin-bottom: 10px;
        }

        .screen-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .screen-option {
            background: #333;
            border-radius: 10px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            text-align: center;
        }

        .screen-option:hover {
            background: #3a3a3a;
            border-color: #2d8cff;
            transform: translateY(-5px);
        }

        .screen-option i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #2d8cff;
        }

        .screen-option h4 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .screen-option p {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .screen-option.active {
            border-color: #2d8cff;
            background: #2d8cff33;
        }

        .screen-preview {
            margin-top: 30px;
            border-radius: 10px;
            overflow: hidden;
            background: #000;
            display: none;
        }

        .screen-preview.active {
            display: block;
        }

        .screen-preview video {
            width: 100%;
            max-height: 300px;
            object-fit: contain;
        }

        .screen-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .screen-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .start-share-btn {
            background: #2d8cff;
            color: white;
        }

        .start-share-btn:hover {
            background: #1a73e8;
        }

        .cancel-share-btn {
            background: #666;
            color: white;
        }

        .cancel-share-btn:hover {
            background: #555;
        }

        /* ИНДИКАТОР ДЕМОНСТРАЦИИ ЭКРАНА */
        .screen-share-indicator {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1002;
            animation: slideDown 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .screen-share-indicator .stop-share-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }

        .screen-share-indicator .stop-share-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        @keyframes slideDown {
            from { transform: translate(-50%, -100%); opacity: 0; }
            to { transform: translate(-50%, 0); opacity: 1; }
        }

        /* Панель записи */
        .recording-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 68, 68, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1002;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .recording-dot {
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Кнопки управления встречей */
        .meeting-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 1001;
        }

        .meeting-control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: #2d8cff;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .meeting-control-btn:hover {
            background: #1a73e8;
            transform: scale(1.1);
        }

        .meeting-control-btn.recording {
            background: #ff4444;
        }

        .meeting-control-btn.leave {
            background: #ff4444;
        }

        .meeting-control-btn.leave:hover {
            background: #cc0000;
        }

        .meeting-control-btn.screen-sharing {
            background: #28a745;
            animation: pulse-green 2s infinite;
        }

        @keyframes pulse-green {
            0%, 100% { background-color: #28a745; }
            50% { background-color: #34ce57; }
        }

        /* Модальное окно с записями */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 80vh;
            overflow-y: auto;
            color: #333;
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            color: #0c5c8c;
            margin: 0;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            color: #666;
            cursor: pointer;
        }

        .modal-content {
            padding: 30px;
        }

        .recordings-list {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .recording-item {
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s;
            border: 1px solid #eee;
        }

        .recording-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .recording-thumbnail {
            width: 100%;
            height: 180px;
            background: #222;
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }

        .recording-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .recording-thumbnail:hover img {
            transform: scale(1.05);
        }

        .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .recording-thumbnail:hover .play-overlay {
            opacity: 1;
        }

        .play-overlay i {
            font-size: 48px;
            color: white;
            background: rgba(45, 140, 255, 0.8);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .recording-info {
            padding: 20px;
        }

        .recording-info h4 {
            margin: 0 0 10px 0;
            color: #0c5c8c;
            font-size: 1.1rem;
        }

        .recording-meta {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .recording-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .play-btn {
            background: #2d8cff;
            color: white;
        }

        .download-btn {
            background: #28a745;
            color: white;
        }

        .delete-btn {
            background: #ff4444;
            color: white;
        }

        /* Особенности */
        .features {
            background: white;
            color: #333;
            padding: 80px 5%;
            text-align: center;
        }

        .features h2 {
            font-size: 2.5rem;
            margin-bottom: 50px;
            color: #0c5c8c;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-card {
            background: #f5f9ff;
            padding: 30px;
            border-radius: 10px;
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-10px);
        }

        .feature-card i {
            font-size: 40px;
            color: #2d8cff;
            margin-bottom: 20px;
        }

        .feature-card h3 {
            margin-bottom: 15px;
            color: #0c5c8c;
        }

        /* Анимации */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* Адаптивность */
        @media (max-width: 992px) {
            .hero {
                flex-direction: column;
                text-align: center;
            }
            .hero-text {
                padding-right: 0;
                margin-bottom: 50px;
            }
            .meeting-controls {
                flex-wrap: wrap;
                justify-content: center;
                bottom: 10px;
            }
            .meeting-control-btn {
                width: 50px;
                height: 50px;
                font-size: 1rem;
            }
            .recordings-list {
                grid-template-columns: 1fr;
            }
            .screen-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Шапка -->
    <header>
        <div class="logo" onclick="showMainPage()">MyVidio</div>
        <div class="auth-buttons">
            <button class="sign-in" id="viewRecordingsBtn">
                <i class="fas fa-video"></i> Мои записи
            </button>
            <button class="sign-up" id="registerBtn">Регистрация</button>
        </div>
    </header>

    <!-- Основной блок -->
    <section class="hero" id="mainPage">
        <div class="hero-text">
            <h1>Демонстрация экрана в реальном времени</h1>
            <p>Показывайте презентации, документы и рабочий стол прямо во время видеоконференции. Полная интеграция с Jitsi.</p>
            <div class="cta-buttons">
                <button class="meeting-btn" id="quickMeeting">
                    <i class="fas fa-bolt"></i> Быстрая встреча
                </button>
                <button class="meeting-btn record-btn" id="recordedMeeting">
                    <i class="fas fa-record-vinyl"></i> Встреча с демонстрацией
                </button>
            </div>
            
            <div style="margin-top: 30px; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px;">
                <h3><i class="fas fa-desktop"></i> Что можно демонстрировать:</h3>
                <p>• Весь экран или отдельное окно • Презентации PowerPoint • Веб-страницы • Документы • Видео и анимации</p>
            </div>
        </div>
        
        <div class="room-creator">
            <h3><i class="fas fa-video"></i> Настройки конференции</h3>
            
            <div class="form-group">
                <label for="roomName">Название комнаты</label>
                <input type="text" id="roomName" placeholder="Моя-презентация-123">
            </div>
            
            <div class="form-group">
                <label for="userName">Ваше имя</label>
                <input type="text" id="userName" placeholder="Докладчик" value="Ведущий">
            </div>
            
            <div class="form-group">
                <label for="recordingMode">Режим записи</label>
                <select id="recordingMode">
                    <option value="none">Без записи</option>
                    <option value="audio">Только аудио</option>
                    <option value="video" selected>Видео + аудио + экран</option>
                    <option value="stream">Прямая трансляция</option>
                </select>
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="autoRecord" checked>
                <label for="autoRecord">Автоматически начать запись</label>
            </div>
            
            <button class="meeting-btn" id="createMeeting" style="width: 100%; margin-top: 20px;">
                <i class="fas fa-rocket"></i> Создать конференцию
            </button>
        </div>
    </section>

    <!-- Контейнер для Jitsi -->
    <div id="meet-container"></div>
    
    <!-- МЕНЮ ВЫБОРА ЭКРАНА -->
    <div class="screen-select-overlay" id="screenSelectOverlay">
        <div class="screen-select-modal">
            <div class="screen-select-header">
                <h3><i class="fas fa-desktop"></i> Выберите что показать</h3>
                <p>Выберите экран, окно или вкладку для демонстрации</p>
            </div>
            
            <div class="screen-options">
                <div class="screen-option" data-type="entire-screen" onclick="selectScreenOption('entire-screen')">
                    <i class="fas fa-desktop"></i>
                    <h4>Весь экран</h4>
                    <p>Покажите весь ваш экран со всеми окнами</p>
                    <div class="option-badge">Рекомендуется</div>
                </div>
                
                <div class="screen-option" data-type="application-window" onclick="selectScreenOption('application-window')">
                    <i class="fas fa-window-maximize"></i>
                    <h4>Окно приложения</h4>
                    <p>Только одно выбранное окно программы</p>
                    <div class="option-badge">Для презентаций</div>
                </div>
                
                <div class="screen-option" data-type="browser-tab" onclick="selectScreenOption('browser-tab')">
                    <i class="fas fa-window-restore"></i>
                    <h4>Вкладка браузера</h4>
                    <p>Только одну вкладку в браузере</p>
                    <div class="option-badge">Для веб-демонстраций</div>
                </div>
            </div>
            
            <div class="screen-preview" id="screenPreview">
                <video id="previewVideo" autoplay muted playsinline></video>
            </div>
            
            <div class="screen-controls">
                <button class="screen-btn cancel-share-btn" id="cancelShareBtn">
                    <i class="fas fa-times"></i> Отмена
                </button>
                <button class="screen-btn start-share-btn" id="startShareBtn">
                    <i class="fas fa-share"></i> Начать демонстрацию
                </button>
            </div>
        </div>
    </div>
    
    <!-- ИНДИКАТОР ДЕМОНСТРАЦИИ ЭКРАНА -->
    <div class="screen-share-indicator" id="screenShareIndicator" style="display: none;">
        <i class="fas fa-desktop"></i>
        <span>Вы демонстрируете экран</span>
        <button class="stop-share-btn" id="stopShareBtn">
            <i class="fas fa-stop"></i> Остановить
        </button>
    </div>

    <!-- ВИДЕО ПЛЕЕР -->
    <div class="video-player-container" id="videoPlayerContainer">
        <div class="video-player">
            <div class="video-player-header">
                <h3 id="playerTitle">Просмотр записи</h3>
                <button class="close-player" id="closePlayer">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="video-wrapper">
                <video id="videoPlayer" preload="metadata">
                    <source id="videoSource" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
            
            <div class="player-controls">
                <button class="control-btn play-pause-btn" id="playPauseBtn">
                    <i class="fas fa-play" id="playIcon"></i>
                </button>
                
                <button class="control-btn" id="rewind10s">
                    <i class="fas fa-backward"></i>
                </button>
                
                <button class="control-btn" id="forward10s">
                    <i class="fas fa-forward"></i>
                </button>
                
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar" id="progressBar"></div>
                    <div class="progress-slider" id="progressSlider"></div>
                </div>
                
                <div class="time-display">
                    <span id="currentTime">00:00</span> / <span id="duration">00:00</span>
                </div>
                
                <div class="volume-control">
                    <button class="control-btn" id="muteBtn">
                        <i class="fas fa-volume-up" id="volumeIcon"></i>
                    </button>
                    <div class="volume-slider" id="volumeSlider">
                        <div class="volume-level" id="volumeLevel"></div>
                        <div class="volume-slider-handle" id="volumeHandle"></div>
                    </div>
                </div>
                
                <div class="player-settings">
                    <button class="control-btn" id="settingsBtn">
                        <i class="fas fa-cog"></i>
                    </button>
                    <div class="settings-menu" id="settingsMenu">
                        <div class="settings-option">
                            <span>Скорость</span>
                            <div class="speed-options" id="speedOptions">
                                <button class="speed-btn" data-speed="0.5">0.5x</button>
                                <button class="speed-btn active" data-speed="1">1x</button>
                                <button class="speed-btn" data-speed="1.5">1.5x</button>
                                <button class="speed-btn" data-speed="2">2x</button>
                            </div>
                        </div>
                        <div class="settings-option">
                            <span>Качество</span>
                            <select id="qualitySelect">
                                <option value="auto">Авто</option>
                                <option value="1080">1080p</option>
                                <option value="720">720p</option>
                                <option value="480">480p</option>
                            </select>
                        </div>
                        <div class="settings-option">
                            <span>Субтитры</span>
                            <select id="subtitlesSelect">
                                <option value="none">Выкл</option>
                                <option value="ru">Русский</option>
                                <option value="en">Английский</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <button class="control-btn" id="fullscreenBtn">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Панель записи -->
    <div class="recording-panel" id="recordingPanel" style="display: none;">
        <div class="recording-dot"></div>
        <span id="recordingTimer">00:00</span>
        <span>Идёт запись...</span>
    </div>
    
    <!-- Кнопки управления в конференции -->
    <div class="meeting-controls" id="meetingControls" style="display: none;">
        <button class="meeting-control-btn" id="toggleVideo">
            <i class="fas fa-video"></i>
        </button>
        <button class="meeting-control-btn" id="toggleAudio">
            <i class="fas fa-microphone"></i>
        </button>
        <button class="meeting-control-btn" id="startRecording">
            <i class="fas fa-record-vinyl"></i>
        </button>
        <button class="meeting-control-btn" id="shareScreen">
            <i class="fas fa-desktop"></i>
        </button>
        <button class="meeting-control-btn" id="toggleChat">
            <i class="fas fa-comment"></i>
        </button>
        <button class="meeting-control-btn leave" id="leaveMeeting">
            <i class="fas fa-phone-slash"></i>
        </button>
    </div>

    <!-- Модальное окно с записями -->
    <div class="modal-overlay" id="recordingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-video"></i> Мои записи встреч</h2>
                <button class="close-modal" id="closeRecordingsModal">&times;</button>
            </div>
            <div class="modal-content">
                <p>Все ваши записи сохраняются в течение 30 дней. Нажмите на запись для просмотра.</p>
                
                <div class="recordings-list" id="recordingsList">
                    <!-- Записи будут добавляться здесь -->
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="meeting-btn" id="refreshRecordings">
                        <i class="fas fa-sync"></i> Обновить список
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Особенности -->
    <section class="features">
        <h2>Возможности демонстрации экрана</h2>
        <div class="features-grid">
            <div class="feature-card">
                <i class="fas fa-desktop"></i>
                <h3>Весь экран или окно</h3>
                <p>Выбирайте между демонстрацией всего экрана или отдельных окон</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-mouse-pointer"></i>
                <h3>Выделение курсора</h3>
                <p>Участники видят ваш курсор и клики для лучшего понимания</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-video"></i>
                <h3>Параллельная трансляция</h3>
                <p>Показывайте экран одновременно с вашей видеокамерой</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-pen"></i>
                <h3>Аннотации на экране</h3>
                <p>Рисуйте и выделяйте важные элементы прямо на экране</p>
            </div>
        </div>
    </section>

    <script>
        // Jitsi объект
        let api = null;
        let isRecording = false;
        let isScreenSharing = false;
        let recordingStartTime = null;
        let recordingTimer = null;
        let screenStream = null;
        let selectedScreenType = 'entire-screen';
        
        // Объект видео плеера
        let videoPlayer = null;
        let isPlaying = false;
        let isDraggingProgress = false;
        let isDraggingVolume = false;
        let currentPlaybackRate = 1;
        let currentVolume = 0.7;
        let isMuted = false;
        
        // Данные записей
        let recordedSessions = JSON.parse(localStorage.getItem('myvidio_recordings') || '[]');
        
        // Добавим тестовые записи, если их нет
        if (recordedSessions.length === 0) {
            recordedSessions = [
                {
                    id: 'demo1',
                    title: 'Демонстрация экрана: Презентация',
                    date: '15.12.2023 10:30',
                    duration: '45:22',
                    size: '320 MB',
                    status: 'ready',
                    thumbnail: 'https://images.unsplash.com/photo-1559136555-9303baea8ebd?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=180&w=320',
                    videoUrl: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
                },
                {
                    id: 'demo2',
                    title: 'Обзор нового интерфейса',
                    date: '14.12.2023 14:15',
                    duration: '1:22:45',
                    size: '850 MB',
                    status: 'ready',
                    thumbnail: 'https://images.unsplash.com/photo-1587829741301-dc798b83add3?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=180&w=320',
                    videoUrl: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4'
                },
                {
                    id: 'demo3',
                    title: 'Онлайн-обучение с демонстрацией',
                    date: '13.12.2023 09:00',
                    duration: '2:15:30',
                    size: '1.2 GB',
                    status: 'processing',
                    thumbnail: 'https://images.unsplash.com/photo-1515187029135-18ee286d815b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=180&w=320',
                    videoUrl: ''
                }
            ];
            localStorage.setItem('myvidio_recordings', JSON.stringify(recordedSessions));
        }
        
        // Элементы DOM
        const meetContainer = document.getElementById('meet-container');
        const meetingControls = document.getElementById('meetingControls');
        const recordingPanel = document.getElementById('recordingPanel');
        const recordingTimerEl = document.getElementById('recordingTimer');
        const quickMeetingBtn = document.getElementById('quickMeeting');
        const recordedMeetingBtn = document.getElementById('recordedMeeting');
        const createMeetingBtn = document.getElementById('createMeeting');
        const startRecordingBtn = document.getElementById('startRecording');
        const shareScreenBtn = document.getElementById('shareScreen');
        const viewRecordingsBtn = document.getElementById('viewRecordingsBtn');
        const recordingsModal = document.getElementById('recordingsModal');
        const closeRecordingsModal = document.getElementById('closeRecordingsModal');
        const recordingsList = document.getElementById('recordingsList');
        const refreshRecordingsBtn = document.getElementById('refreshRecordings');
        
        // Элементы демонстрации экрана
        const screenSelectOverlay = document.getElementById('screenSelectOverlay');
        const screenShareIndicator = document.getElementById('screenShareIndicator');
        const stopShareBtn = document.getElementById('stopShareBtn');
        const cancelShareBtn = document.getElementById('cancelShareBtn');
        const startShareBtn = document.getElementById('startShareBtn');
        const previewVideo = document.getElementById('previewVideo');
        const screenPreview = document.getElementById('screenPreview');
        
        // Элементы видео плеера
        const videoPlayerContainer = document.getElementById('videoPlayerContainer');
        const videoPlayerEl = document.getElementById('videoPlayer');
        const videoSource = document.getElementById('videoSource');
        const playerTitle = document.getElementById('playerTitle');
        const closePlayerBtn = document.getElementById('closePlayer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playIcon = document.getElementById('playIcon');
        const rewindBtn = document.getElementById('rewind10s');
        const forwardBtn = document.getElementById('forward10s');
        const progressContainer = document.getElementById('progressContainer');
        const progressBar = document.getElementById('progressBar');
        const progressSlider = document.getElementById('progressSlider');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const muteBtn = document.getElementById('muteBtn');
        const volumeIcon = document.getElementById('volumeIcon');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeLevel = document.getElementById('volumeLevel');
        const volumeHandle = document.getElementById('volumeHandle');
        const settingsBtn = document.getElementById('settingsBtn');
        const settingsMenu = document.getElementById('settingsMenu');
        const speedOptions = document.getElementById('speedOptions');
        const qualitySelect = document.getElementById('qualitySelect');
        const subtitlesSelect = document.getElementById('subtitlesSelect');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        
        // Форма настроек
        const roomNameInput = document.getElementById('roomName');
        const userNameInput = document.getElementById('userName');
        const recordingModeSelect = document.getElementById('recordingMode');
        const autoRecordCheckbox = document.getElementById('autoRecord');
        
        // Генератор случайных комнат
        function generateRoomName() {
            const adjectives = ['Презентация', 'Демонстрация', 'Обучение', 'Воркшоп', 'Совещание', 'Вебинар'];
            const nouns = ['Экрана', 'Проекта', 'Документа', 'Интерфейса', 'Кода', 'Дизайна'];
            const randomNum = Math.floor(Math.random() * 1000);
            
            const adj = adjectives[Math.floor(Math.random() * adjectives.length)];
            const noun = nouns[Math.floor(Math.random() * nouns.length)];
            
            return `${adj}-${noun}-${randomNum}`;
        }
        
        // Инициализация
        roomNameInput.value = generateRoomName();
        videoPlayer = videoPlayerEl;
        
        // Инициализация видео плеера
        function initVideoPlayer() {
            // Установка начального объема
            videoPlayer.volume = currentVolume;
            volumeLevel.style.width = (currentVolume * 100) + '%';
            volumeHandle.style.right = ((1 - currentVolume) * 100) + '%';
            
            // Обновление времени
            videoPlayer.addEventListener('timeupdate', updateProgress);
            videoPlayer.addEventListener('loadedmetadata', updateDuration);
            videoPlayer.addEventListener('ended', onVideoEnded);
            
            // Управление воспроизведением
            playPauseBtn.addEventListener('click', togglePlay);
            rewindBtn.addEventListener('click', () => seek(-10));
            forwardBtn.addEventListener('click', () => seek(10));
            
            // Прогресс бар
            progressContainer.addEventListener('mousedown', startDraggingProgress);
            document.addEventListener('mousemove', dragProgress);
            document.addEventListener('mouseup', stopDraggingProgress);
            
            // Регулировка громкости
            muteBtn.addEventListener('click', toggleMute);
            volumeSlider.addEventListener('mousedown', startDraggingVolume);
            document.addEventListener('mousemove', dragVolume);
            document.addEventListener('mouseup', stopDraggingVolume);
            
            // Настройки
            settingsBtn.addEventListener('click', toggleSettingsMenu);
            speedOptions.addEventListener('click', changePlaybackSpeed);
            qualitySelect.addEventListener('change', changeQuality);
            subtitlesSelect.addEventListener('change', changeSubtitles);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            
            // Закрытие плеера
            closePlayerBtn.addEventListener('click', closeVideoPlayer);
            videoPlayerContainer.addEventListener('click', (e) => {
                if (e.target === videoPlayerContainer) {
                    closeVideoPlayer();
                }
            });
            
            // Горячие клавиши
            document.addEventListener('keydown', handleKeyPress);
        }
        
        // Функции видео плеера (остаются такими же)
        function togglePlay() {
            if (videoPlayer.paused || videoPlayer.ended) {
                videoPlayer.play();
                isPlaying = true;
                playIcon.className = 'fas fa-pause';
            } else {
                videoPlayer.pause();
                isPlaying = false;
                playIcon.className = 'fas fa-play';
            }
        }
        
        function seek(seconds) {
            videoPlayer.currentTime += seconds;
        }
        
        function updateProgress() {
            const percent = (videoPlayer.currentTime / videoPlayer.duration) * 100 || 0;
            progressBar.style.width = percent + '%';
            progressSlider.style.left = percent + '%';
            
            currentTimeEl.textContent = formatTime(videoPlayer.currentTime);
        }
        
        function updateDuration() {
            durationEl.textContent = formatTime(videoPlayer.duration);
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        function onVideoEnded() {
            isPlaying = false;
            playIcon.className = 'fas fa-play';
        }
        
        function startDraggingProgress(e) {
            isDraggingProgress = true;
            updateProgressPosition(e);
        }
        
        function dragProgress(e) {
            if (!isDraggingProgress) return;
            updateProgressPosition(e);
        }
        
        function stopDraggingProgress() {
            isDraggingProgress = false;
        }
        
        function updateProgressPosition(e) {
            const rect = progressContainer.getBoundingClientRect();
            let percent = (e.clientX - rect.left) / rect.width;
            percent = Math.max(0, Math.min(1, percent));
            
            progressBar.style.width = (percent * 100) + '%';
            progressSlider.style.left = (percent * 100) + '%';
            
            videoPlayer.currentTime = percent * videoPlayer.duration;
            currentTimeEl.textContent = formatTime(videoPlayer.currentTime);
        }
        
        function toggleMute() {
            isMuted = !isMuted;
            videoPlayer.muted = isMuted;
            volumeIcon.className = isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up';
            
            if (!isMuted) {
                videoPlayer.volume = currentVolume;
            }
        }
        
        function startDraggingVolume(e) {
            isDraggingVolume = true;
            updateVolumePosition(e);
            e.preventDefault();
        }
        
        function dragVolume(e) {
            if (!isDraggingVolume) return;
            updateVolumePosition(e);
        }
        
        function stopDraggingVolume() {
            isDraggingVolume = false;
        }
        
        function updateVolumePosition(e) {
            const rect = volumeSlider.getBoundingClientRect();
            let percent = 1 - ((e.clientX - rect.left) / rect.width);
            percent = Math.max(0, Math.min(1, percent));
            
            currentVolume = percent;
            videoPlayer.volume = currentVolume;
            videoPlayer.muted = false;
            isMuted = false;
            
            volumeLevel.style.width = (percent * 100) + '%';
            volumeHandle.style.right = ((1 - percent) * 100) + '%';
            volumeIcon.className = percent === 0 ? 'fas fa-volume-mute' : 'fas fa-volume-up';
        }
        
        function toggleSettingsMenu() {
            settingsMenu.classList.toggle('show');
        }
        
        function changePlaybackSpeed(e) {
            if (e.target.classList.contains('speed-btn')) {
                document.querySelectorAll('.speed-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                e.target.classList.add('active');
                
                const speed = parseFloat(e.target.dataset.speed);
                currentPlaybackRate = speed;
                videoPlayer.playbackRate = speed;
            }
        }
        
        function changeQuality() {
            const quality = qualitySelect.value;
            showNotification(`Качество изменено на ${quality === 'auto' ? 'авто' : quality + 'p'}`);
        }
        
        function changeSubtitles() {
            const lang = subtitlesSelect.value;
            showNotification(lang === 'none' ? 'Субтитры выключены' : `Субтитры: ${lang === 'ru' ? 'русский' : 'английский'}`);
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                videoPlayerContainer.requestFullscreen().catch(err => {
                    console.log(`Ошибка полноэкранного режима: ${err.message}`);
                });
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
            } else {
                document.exitFullscreen();
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
            }
        }
        
        function closeVideoPlayer() {
            videoPlayerContainer.style.display = 'none';
            videoPlayer.pause();
            isPlaying = false;
            playIcon.className = 'fas fa-play';
            settingsMenu.classList.remove('show');
        }
        
        function playRecording(videoUrl, title) {
            videoSource.src = videoUrl;
            videoPlayer.load();
            playerTitle.textContent = title || 'Просмотр записи';
            videoPlayerContainer.style.display = 'flex';
            
            setTimeout(() => {
                videoPlayer.play().catch(e => {
                    console.log('Автовоспроизведение заблокировано:', e);
                    playIcon.className = 'fas fa-play';
                });
            }, 500);
        }
        
        function handleKeyPress(e) {
            if (!videoPlayerContainer.style.display || videoPlayerContainer.style.display === 'none') {
                return;
            }
            
            switch(e.key.toLowerCase()) {
                case ' ':
                case 'k':
                    e.preventDefault();
                    togglePlay();
                    break;
                case 'm':
                    e.preventDefault();
                    toggleMute();
                    break;
                case 'arrowleft':
                    e.preventDefault();
                    seek(-5);
                    break;
                case 'arrowright':
                    e.preventDefault();
                    seek(5);
                    break;
                case 'arrowup':
                    e.preventDefault();
                    currentVolume = Math.min(1, currentVolume + 0.1);
                    videoPlayer.volume = currentVolume;
                    volumeLevel.style.width = (currentVolume * 100) + '%';
                    volumeHandle.style.right = ((1 - currentVolume) * 100) + '%';
                    break;
                case 'arrowdown':
                    e.preventDefault();
                    currentVolume = Math.max(0, currentVolume - 0.1);
                    videoPlayer.volume = currentVolume;
                    volumeLevel.style.width = (currentVolume * 100) + '%';
                    volumeHandle.style.right = ((1 - currentVolume) * 100) + '%';
                    break;
                case 'f':
                    e.preventDefault();
                    toggleFullscreen();
                    break;
                case 'escape':
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                        fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    }
                    break;
            }
        }
        
        // ДЕМОНСТРАЦИЯ ЭКРАНА - ОСНОВНЫЕ ФУНКЦИИ
        function selectScreenOption(type) {
            selectedScreenType = type;
            
            // Убираем активный класс у всех опций
            document.querySelectorAll('.screen-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // Добавляем активный класс выбранной опции
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
            
            // Показываем превью
            showScreenPreview(type);
        }
        
        async function showScreenPreview(type) {
            try {
                const constraints = getScreenConstraints(type);
                screenStream = await navigator.mediaDevices.getDisplayMedia(constraints);
                
                // Показываем превью
                previewVideo.srcObject = screenStream;
                screenPreview.classList.add('active');
                
                // Разрешаем начать демонстрацию
                startShareBtn.disabled = false;
                startShareBtn.innerHTML = '<i class="fas fa-share"></i> Начать демонстрацию';
                
                // Обработчик остановки демонстрации через браузер
                screenStream.getVideoTracks()[0].onended = () => {
                    stopScreenSharing();
                };
                
            } catch (error) {
                console.error('Ошибка доступа к экрану:', error);
                showNotification('Не удалось получить доступ к экрану');
                startShareBtn.disabled = true;
                startShareBtn.innerHTML = '<i class="fas fa-exclamation-circle"></i> Ошибка доступа';
            }
        }
        
        function getScreenConstraints(type) {
            const constraints = {
                video: {
                    displaySurface: type === 'browser-tab' ? 'browser' : 
                                   type === 'application-window' ? 'window' : 'monitor',
                    frameRate: { ideal: 30, max: 60 },
                    width: { ideal: 1920, max: 1920 },
                    height: { ideal: 1080, max: 1080 }
                },
                audio: true // Захватываем звук с системы
            };
            
            // Для Chrome/Edge добавляем surfaceSwitching
            if (navigator.userAgent.includes('Chrome')) {
                constraints.video.surfaceSwitching = 'include';
            }
            
            return constraints;
        }
        
        async function startScreenSharing() {
            if (!screenStream) {
                showNotification('Сначала выберите экран для демонстрации');
                return;
            }
            
            try {
                // Если есть API Jitsi, используем его
                if (api) {
                    // Получаем видеотрек из потока экрана
                    const screenTrack = screenStream.getVideoTracks()[0];
                    
                    // Используем Jitsi API для демонстрации экрана
                    await api.executeCommand('toggleShareScreen', true);
                    
                    isScreenSharing = true;
                    updateScreenSharingUI(true);
                    
                    screenSelectOverlay.style.display = 'none';
                    showNotification('Демонстрация экрана начата');
                    
                } else {
                    // Реализация без Jitsi (для демо)
                    isScreenSharing = true;
                    updateScreenSharingUI(true);
                    
                    screenSelectOverlay.style.display = 'none';
                    showNotification('Демонстрация экрана начата (демо-режим)');
                    
                    // В реальном приложении здесь была бы отправка потока через WebRTC
                    console.log('Screen sharing started:', screenStream);
                }
                
            } catch (error) {
                console.error('Ошибка демонстрации экрана:', error);
                showNotification('Не удалось начать демонстрацию экрана');
                stopScreenSharing();
            }
        }
        
        function stopScreenSharing() {
            if (screenStream) {
                // Останавливаем все треки
                screenStream.getTracks().forEach(track => track.stop());
                screenStream = null;
            }
            
            if (api && isScreenSharing) {
                try {
                    api.executeCommand('toggleShareScreen', false);
                } catch (e) {
                    console.log('Jitsi API error:', e);
                }
            }
            
            isScreenSharing = false;
            updateScreenSharingUI(false);
            
            // Скрываем превью
            screenPreview.classList.remove('active');
            previewVideo.srcObject = null;
            
            showNotification('Демонстрация экрана остановлена');
        }
        
        function updateScreenSharingUI(isSharing) {
            if (isSharing) {
                // Обновляем кнопку
                shareScreenBtn.classList.add('screen-sharing');
                shareScreenBtn.innerHTML = '<i class="fas fa-stop"></i>';
                
                // Показываем индикатор
                screenShareIndicator.style.display = 'flex';
                
                // Меняем текст на кнопке остановки
                stopShareBtn.innerHTML = '<i class="fas fa-stop"></i> Остановить';
                
            } else {
                // Возвращаем обычную кнопку
                shareScreenBtn.classList.remove('screen-sharing');
                shareScreenBtn.innerHTML = '<i class="fas fa-desktop"></i>';
                
                // Скрываем индикатор
                screenShareIndicator.style.display = 'none';
            }
        }
        
        // Обработчики для демонстрации экрана
        shareScreenBtn.addEventListener('click', () => {
            if (isScreenSharing) {
                stopScreenSharing();
            } else {
                screenSelectOverlay.style.display = 'flex';
                startShareBtn.disabled = true;
                startShareBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Загрузка...';
                
                // Сбрасываем выбор
                document.querySelectorAll('.screen-option').forEach(option => {
                    option.classList.remove('active');
                });
                screenPreview.classList.remove('active');
            }
        });
        
        startShareBtn.addEventListener('click', startScreenSharing);
        stopShareBtn.addEventListener('click', stopScreenSharing);
        cancelShareBtn.addEventListener('click', () => {
            screenSelectOverlay.style.display = 'none';
            if (screenStream) {
                screenStream.getTracks().forEach(track => track.stop());
                screenStream = null;
            }
        });
        
        // Функции для управления встречей
        function createMeeting(withRecording) {
            const roomName = roomNameInput.value.trim().replace(/\s+/g, '-') || generateRoomName();
            const userName = userNameInput.value.trim() || 'Ведущий';
            
            if (roomName.length < 3) {
                alert('Название комнаты должно быть не менее 3 символов');
                return;
            }
            
            // Скрываем основной контент
            document.getElementById('mainPage').style.display = 'none';
            document.querySelector('.features').style.display = 'none';
            document.querySelector('header').style.display = 'none';
            
            // Показываем контейнер и контролы
            meetContainer.style.display = 'block';
            meetingControls.style.display = 'flex';
            
            // Настройки Jitsi
            const domain = 'meet.jit.si';
            const options = {
                roomName: roomName,
                width: '100%',
                height: '100%',
                parentNode: meetContainer,
                userInfo: {
                    displayName: userName,
                    email: '',
                },
                configOverwrite: {
                    startWithAudioMuted: false,
                    startWithVideoMuted: false,
                    enableWelcomePage: false,
                    enableClosePage: false,
                    // Включаем демонстрацию экрана
                    enableScreensharing: true,
                    desktopSharingFrameRate: {
                        min: 5,
                        max: 30
                    },
                    // Разрешаем демонстрацию экрана в Chrome
                    desktopSharingChromeExtId: null,
                    // Разрешаем выбор источника экрана
                    desktopSharingSources: ['screen', 'window', 'tab']
                },
                interfaceConfigOverwrite: {
                    APP_NAME: 'MyVidio',
                    SHOW_CHROME_EXTENSION_BANNER: false,
                    MOBILE_APP_PROMO: false,
                    // Включаем кнопку демонстрации экрана
                    TOOLBAR_BUTTONS: [
                        'microphone', 'camera', 'closedcaptions', 'desktop', 'fullscreen',
                        'fodeviceselection', 'hangup', 'profile', 'chat', 'recording',
                        'livestreaming', 'etherpad', 'sharedvideo', 'settings', 'raisehand',
                        'videoquality', 'filmstrip', 'invite', 'feedback', 'stats', 'shortcuts',
                        'tileview', 'videobackgroundblur', 'download', 'help', 'mute-everyone',
                        'security'
                    ],
                    // Настройки для демонстрации экрана
                    SHOW_SCREENSHARING_BUTTON: true,
                    SCREENSHARING_SELF_VIDEO: true
                }
            };
            
            // Создаем встречу
            api = new JitsiMeetExternalAPI(domain, options);
            
            // Обработчики событий Jitsi
            api.addEventListeners({
                readyToClose: () => {
                    endMeeting();
                },
                participantJoined: (participant) => {
                    console.log('Участник присоединился:', participant);
                    showNotification(`Участник ${participant.displayName} присоединился`);
                },
                participantLeft: (participant) => {
                    console.log('Участник вышел:', participant);
                    showNotification(`Участник ${participant.displayName} вышел`);
                },
                screenSharingStatusChanged: (data) => {
                    console.log('Статус демонстрации экрана изменился:', data);
                    if (data.on) {
                        isScreenSharing = true;
                        updateScreenSharingUI(true);
                        showNotification('Вы начали демонстрацию экрана');
                    } else {
                        isScreenSharing = false;
                        updateScreenSharingUI(false);
                        showNotification('Демонстрация экрана остановлена');
                    }
                }
            });
            
            // Автоматически начать запись (имитация)
            if (withRecording && autoRecordCheckbox.checked) {
                setTimeout(() => {
                    startRecording();
                }, 3000);
            }
            
            // Копируем ссылку в буфер обмена
            const inviteLink = `https://${domain}/${roomName}`;
            setTimeout(() => {
                navigator.clipboard.writeText(inviteLink).then(() => {
                    showNotification('Ссылка скопирована в буфер обмена! Отправьте её участникам.');
                });
            }, 1000);
        }
        
        // Управление записью
        startRecordingBtn.addEventListener('click', function() {
            if (!isRecording) {
                startRecording();
            } else {
                stopRecording();
            }
        });
        
        function startRecording() {
            if (api) {
                isRecording = true;
                recordingStartTime = new Date();
                startRecordingUI();
                
                showNotification('Запись встречи начата');
                console.log('Запись начата в', recordingStartTime);
            }
        }
        
        function stopRecording() {
            if (api && isRecording) {
                isRecording = false;
                stopRecordingUI();
                
                const record
